/*
  samebug-notifier-1.0.2
  A JavaScript Notifier for samebug.io
  https://github.com/samebug/samebug-notifier-js
  http://samebug.io
  MIT license
  Copyright (c) 2014 Samebug Ltd.
*/!function(a){function b(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function c(a){return"undefined"==typeof a}var d={},e=a.TraceKit,f=[].slice,g="?";d.noConflict=function(){return a.TraceKit=e,d},d.wrap=function(a){function b(){try{return a.apply(this,arguments)}catch(b){throw d.report(b),b}}return b},d.report=function(){function c(a){i.push(a)}function e(a){for(var b=i.length-1;b>=0;--b)i[b]===a&&i.splice(b,1)}function g(a,c){var e=null;if(!c||d.collectWindowErrors){for(var g in i)if(b(i,g))try{i[g].apply(null,[a].concat(f.call(arguments,2)))}catch(h){e=h}if(e)throw e}}function h(b){var c=f.call(arguments,1);if(k){if(j===b)return;var e=k;k=null,j=null,g.apply(null,[e,null].concat(c))}var h=d.computeStackTrace(b);throw k=h,j=b,a.setTimeout(function(){j===b&&(k=null,j=null,g.apply(null,[h,null].concat(c)))},h.incomplete?2e3:0),b}var i=[],j=null,k=null,l=a.onerror;return a.onerror=function(a,b,c){var e=null;if(k)d.computeStackTrace.augmentStackTraceWithInitialElement(k,b,c,a),e=k,k=null,j=null;else{var f={url:b,line:c};f.func=d.computeStackTrace.guessFunctionName(f.url,f.line),f.context=d.computeStackTrace.gatherContext(f.url,f.line),e={mode:"onerror",message:a,url:document.location.href,stack:[f],useragent:navigator.userAgent}}if(l){var h=l.apply(this,arguments);return h&&h.notifyTraceKitHandlers===!1||g(e,"from window.onerror"),h}return g(e,"from window.onerror"),!1},h.subscribe=c,h.unsubscribe=e,h}(),d.computeStackTrace=function(){function e(b){function c(){try{return new a.XMLHttpRequest}catch(b){return new a.ActiveXObject("Microsoft.XMLHTTP")}}if(!d.remoteFetching)return"";try{var e=c();return e.open("GET",b,!1),e.send(""),e.responseText}catch(f){return""}}function f(a){if(!b(w,a)){var c="";-1!==a.indexOf(document.domain)&&(c=e(a)),w[a]=c?c.split("\n"):[]}return w[a]}function h(a,b){var d,e=/function ([^(]*)\(([^)]*)\)/,h=/['"]?([0-9A-Za-z$_]+)['"]?\s*[:=]\s*(function|eval|new Function)/,i="",j=10,k=f(a);if(!k.length)return g;for(var l=0;j>l;++l)if(i=k[b-l]+i,!c(i)){if(d=h.exec(i))return d[1];if(d=e.exec(i))return d[1]}return g}function i(a,b){var e=f(a);if(!e.length)return null;var g=[],h=Math.floor(d.linesOfContext/2),i=h+d.linesOfContext%2,j=Math.max(0,b-h-1),k=Math.min(e.length,b+i-1);b-=1;for(var l=j;k>l;++l)c(e[l])||g.push(e[l]);return g.length>0?g:null}function j(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#]/g,"\\$&")}function k(a){return j(a).replace("<","(?:<|&lt;)").replace(">","(?:>|&gt;)").replace("&","(?:&|&amp;)").replace('"','(?:"|&quot;)').replace(/\s+/g,"\\s+")}function l(a,b){for(var c,d,e=0,g=b.length;g>e;++e)if((c=f(b[e])).length&&(c=c.join("\n"),d=a.exec(c)))return{url:b[e],line:c.substring(0,d.index).split("\n").length,column:d.index-c.lastIndexOf("\n",d.index)-1};return null}function m(a,b,c){var d,e=f(b),g=new RegExp("\\b"+j(a)+"\\b");return c-=1,e&&e.length>c&&(d=g.exec(e[c]))?d.index:null}function n(b){for(var c,d,e,f,g=[a.location.href],h=document.getElementsByTagName("script"),i=""+b,m=/^function(?:\s+([\w$]+))?\s*\(([\w\s,]*)\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,n=/^function on([\w$]+)\s*\(event\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,o=0;o<h.length;++o){var p=h[o];p.src&&g.push(p.src)}if(e=m.exec(i)){var q=e[1]?"\\s+"+e[1]:"",r=e[2].split(",").join("\\s*,\\s*");c=j(e[3]).replace(/;$/,";?"),d=new RegExp("function"+q+"\\s*\\(\\s*"+r+"\\s*\\)\\s*{\\s*"+c+"\\s*}")}else d=new RegExp(j(i).replace(/\s+/g,"\\s+"));if(f=l(d,g))return f;if(e=n.exec(i)){var s=e[1];if(c=k(e[2]),d=new RegExp("on"+s+"=[\\'\"]\\s*"+c+"\\s*[\\'\"]","i"),f=l(d,g[0]))return f;if(d=new RegExp(c),f=l(d,g))return f}return null}function o(a){if(!a.stack)return null;for(var b,c,d=/^\s*at (?:((?:\[object object\])?\S+) )?\(?((?:file|http|https):.*?):(\d+)(?::(\d+))?\)?\s*$/i,e=/^\s*(\S*)(?:\((.*?)\))?@((?:file|http|https).*?):(\d+)(?::(\d+))?\s*$/i,f=a.stack.split("\n"),j=[],k=/^(.*) is undefined$/.exec(a.message),l=0,n=f.length;n>l;++l){if(b=e.exec(f[l]))c={url:b[3],func:b[1]||g,args:b[2]?b[2].split(","):"",line:+b[4],column:b[5]?+b[5]:null};else{if(!(b=d.exec(f[l])))continue;c={url:b[2],func:b[1]||g,line:+b[3],column:b[4]?+b[4]:null}}!c.func&&c.line&&(c.func=h(c.url,c.line)),c.line&&(c.context=i(c.url,c.line)),j.push(c)}return j[0]&&j[0].line&&!j[0].column&&k&&(j[0].column=m(k[1],j[0].url,j[0].line)),j.length?{mode:"stack",name:a.name,message:a.message,url:document.location.href,stack:j,useragent:navigator.userAgent}:null}function p(a){for(var b,c=null!=a.stacktrace?a.stacktrace:a.stack,d=/ line (\d+), column (\d+) in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\) in (.*):\s*$/i,e=c.split("\n"),f=[],g=0,j=e.length;j>g;g+=2)if(b=d.exec(e[g])){var k={line:+b[1],column:+b[2],func:b[3]||b[4],args:b[5]?b[5].split(","):[],url:b[6]};if(!k.func&&k.line&&(k.func=h(k.url,k.line)),k.line)try{k.context=i(k.url,k.line)}catch(l){}k.context||(k.context=[e[g+1]]),f.push(k)}return f.length?{mode:"stacktrace",name:a.name,message:a.message,url:document.location.href,stack:f,useragent:navigator.userAgent}:null}function q(c){var d=c.message.split("\n");if(d.length<4)return null;var e,g,j,m,n=/^\s*Line (\d+) of linked script ((?:file|http|https)\S+)(?:: in function (\S+))?\s*$/i,o=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|http|https)\S+)(?:: in function (\S+))?\s*$/i,p=/^\s*Line (\d+) of function script\s*$/i,q=[],r=document.getElementsByTagName("script"),s=[];for(g in r)b(r,g)&&!r[g].src&&s.push(r[g]);for(g=2,j=d.length;j>g;g+=2){var t=null;if(e=n.exec(d[g]))t={url:e[2],func:e[3],line:+e[1]};else if(e=o.exec(d[g])){t={url:e[3],func:e[4]};var u=+e[1],v=s[e[2]-1];if(v&&(m=f(t.url))){m=m.join("\n");var w=m.indexOf(v.innerText);w>=0&&(t.line=u+m.substring(0,w).split("\n").length)}}else if(e=p.exec(d[g])){var x=a.location.href.replace(/#.*$/,""),y=e[1],z=new RegExp(k(d[g+1]));m=l(z,[x]),t={url:x,line:m?m.line:y,func:""}}if(t){t.func||(t.func=h(t.url,t.line));var A=i(t.url,t.line),B=A?A[Math.floor(A.length/2)]:null;t.context=A&&B.replace(/^\s*/,"")===d[g+1].replace(/^\s*/,"")?A:[d[g+1]],q.push(t)}}return q.length?{mode:"multiline",name:c.name,message:d[0],url:document.location.href,stack:q,useragent:navigator.userAgent}:null}function r(a,b,c,d){var e={url:b,line:c};if(e.url&&e.line){a.incomplete=!1,e.func||(e.func=h(e.url,e.line)),e.context||(e.context=i(e.url,e.line));var f=/ '([^']+)' /.exec(d);if(f&&(e.column=m(f[1],e.url,e.line)),a.stack.length>0&&a.stack[0].url===e.url){if(a.stack[0].line===e.line)return!1;if(!a.stack[0].line&&a.stack[0].func===e.func)return a.stack[0].line=e.line,a.stack[0].context=e.context,!1}return a.stack.unshift(e),a.partial=!0,!0}return a.incomplete=!0,!1}function s(a,b){for(var c,e,f,i=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,j=[],k={},l=!1,o=s.caller;o&&!l;o=o.caller)if(o!==t&&o!==d.report){if(e={url:null,func:g,line:null,column:null},o.name?e.func=o.name:(c=i.exec(o.toString()))&&(e.func=c[1]),f=n(o)){e.url=f.url,e.line=f.line,e.func===g&&(e.func=h(e.url,e.line));var p=/ '([^']+)' /.exec(a.message||a.description);p&&(e.column=m(p[1],f.url,f.line))}k[""+o]?l=!0:k[""+o]=!0,j.push(e)}b&&j.splice(0,b);var q={mode:"callers",name:a.name,message:a.message,url:document.location.href,stack:j,useragent:navigator.userAgent};return r(q,a.sourceURL||a.fileName,a.line||a.lineNumber,a.message||a.description),q}function t(a,b){var c=null;b=null==b?0:+b;try{if(c=p(a))return c}catch(d){if(v)throw d}try{if(c=o(a))return c}catch(d){if(v)throw d}try{if(c=q(a))return c}catch(d){if(v)throw d}try{if(c=s(a,b+1))return c}catch(d){if(v)throw d}return{mode:"failed"}}function u(a){a=(null==a?0:+a)+1;try{throw new Error}catch(b){return t(b,a+1)}return null}var v=!1,w={};return t.augmentStackTraceWithInitialElement=r,t.guessFunctionName=h,t.gatherContext=i,t.ofCaller=u,t}(),function(){var b=function(b){var c=a[b];a[b]=function(){var a=f.call(arguments),b=a[0];return"function"==typeof b&&(a[0]=d.wrap(b)),c.apply?c.apply(this,a):c(a[0],a[1])}};b("setTimeout"),b("setInterval")}(),function(a){if(a){var b=a.event.add;a.event.add=function(c,e,f,g,h){var i;return f.handler?(i=f.handler,f.handler=d.wrap(f.handler)):(i=f,f=d.wrap(f)),f.guid=i.guid?i.guid:i.guid=a.guid++,b.call(this,c,e,f,g,h)};var c=a.fn.ready;a.fn.ready=function(a){return c.call(this,d.wrap(a))};var e=a.ajax;a.ajax=function(b){for(var c,f=["complete","error","success"];c=f.pop();)a.isFunction(b[c])&&(b[c]=d.wrap(b[c]));try{return e.call(this,b)}catch(g){throw d.report(g),g}}}}(a.jQuery),d.remoteFetching||(d.remoteFetching=!0),d.collectWindowErrors||(d.collectWindowErrors=!0),(!d.linesOfContext||d.linesOfContext<1)&&(d.linesOfContext=11),a.TraceKit=d}(window),function(){var a,b,c,d;b=function(){function a(a,b,c){var d,e,f,g,h;g=function(b){var c,d,e,f;return f=null!=b.url&&""!==b.url?b.url:a.url,d=/^.*?([^/]*)$/.exec(f)[1],e=b.line?":"+b.line:"",c=b.column?":"+b.column:"",""+b.func+" ("+d+e+c+") ["+f+"]"},h=null!=a.stack?function(){var b,c,e,f;for(e=a.stack,f=[],b=0,c=e.length;c>b;b++)d=e[b],f.push(g(d));return f}():void 0,f=function(a){return 10>a?"0"+a:""+a},e=function(a){var b,c,d,e,g,h,i,j,k;return d=a.getFullYear(),c=f(a.getMonth()+1),b=f(a.getDate()),g=f(a.getHours()),h=f(a.getMinutes()),k=f(a.getSeconds()),i=-a.getTimezoneOffset(),j=0>i?"-":"+",e=f(Math.abs(i)/60),""+d+"-"+c+"-"+b+"T"+g+":"+h+":"+k+j+e+"00"},this.version=b,this.timestamp=e(c||new Date),this.exception={"class":a.name||"<unknown>",message:a.message||void 0,trace:null!=h&&h.length>0?h.join("\n"):void 0}}return a}(),a=function(){function a(a,b,c,d){var e,f,g,h;f="Javascript",e="application/json",h="1.0.0",g=function(c){var g;if(g=new window.XMLHttpRequest,"withCredentials"in g)g.open("POST",a,!0);else{if(!window.XDomainRequest)throw new Error("CORS not supported");g=new window.XDomainRequest,g.open("POST",a)}return g.timeout=1e4,g.setRequestHeader("Content-Type",e),g.setRequestHeader("X-Samebug-Key",b),g.setRequestHeader("X-Samebug-Platform",f),g.setRequestHeader("X-Samebug-Version",h),g.onload=function(){return c&&c(g.responseText)},g.onerror=function(){return d&&d(g.responseText)},g},this.post=function(a){var b;return b=JSON.stringify(a),g(c,d).send(b)}}return a}(),d={gateway:"http://recorder.samebug.io",autoreport:!0,debug:!1},c=function(){function c(c,e,f){var g,h,i,j,k,l,m,n,o,p,q;if(null==f&&(f={}),!e)throw new Error("Please set Samebug API key");n=function(a){return null!=f[a]?f[a]:d[a]},q=function(){var a,b,c,d;for(c=["gateway","autoreport","version","debug"],d=[],a=0,b=c.length;b>a;a++)k=c[a],d.push(n(k));return d}(),j=q[0],g=q[1],p=q[2],i=q[3],l=function(a){return console.error(a)},m=function(a){return console.log(a)},h=new a(j,e,m,l),this.notify=function(a){if(!a)throw new Error("No exception given");return c.report(a)},o=function(a){var c;return c=new b(a,p),h.post(c)},c.collectWindowErrors=g,c.remoteFetching=!1,c.report.subscribe(o)}return c.init=function(a,b){var d;return d=new c(TraceKit.noConflict(),a,b),c.notify=d.notify},c}(),window.Samebug=c}.call(this);